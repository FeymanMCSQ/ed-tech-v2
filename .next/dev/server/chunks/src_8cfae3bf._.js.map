{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/safi/Desktop/WebDev/ed-tech-v2/src/data/db.ts"],"sourcesContent":["import { PrismaClient } from \"@/prisma\";\n\nconst prismaClientSingleton = () => {\n    return new PrismaClient({\n        accelerateUrl: process.env.DATABASE_URL,\n    });\n};\n\ndeclare global {\n    var prisma: undefined | ReturnType<typeof prismaClientSingleton>;\n}\n\nconst db = globalThis.prisma ?? prismaClientSingleton();\n\nexport default db;\n\nif (process.env.NODE_ENV !== \"production\") globalThis.prisma = db;\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,wBAAwB;IAC1B,OAAO,IAAI,8IAAY,CAAC;QACpB,eAAe,QAAQ,GAAG,CAAC,YAAY;IAC3C;AACJ;AAMA,MAAM,KAAK,WAAW,MAAM,IAAI;uCAEjB;AAEf,wCAA2C,WAAW,MAAM,GAAG"}},
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file:///home/safi/Desktop/WebDev/ed-tech-v2/src/domain/auth.ts"],"sourcesContent":["import bcrypt from \"bcrypt\";\nimport { z } from \"zod\";\n\nexport const LoginSchema = z.object({\n    email: z.string().email(\"Invalid email format\"),\n    password: z.string().min(8, \"Password must be at least 8 characters\"),\n});\n\nexport const RegisterSchema = z.object({\n    email: z.string().email(\"Invalid email format\"),\n    password: z.string().min(8, \"Password must be at least 8 characters\"),\n    displayName: z.string().min(2, \"Display name must be at least 2 characters\").optional().or(z.literal(\"\")),\n});\n\nexport async function hashPassword(password: string): Promise<string> {\n    const saltRounds = 12;\n    return bcrypt.hash(password, saltRounds);\n}\n\nexport async function verifyPassword(password: string, hash: string): Promise<boolean> {\n    return bcrypt.compare(password, hash);\n}\n"],"names":[],"mappings":";;;;;;;;;;AAAA;AACA;;;AAEO,MAAM,cAAc,oLAAC,CAAC,MAAM,CAAC;IAChC,OAAO,oLAAC,CAAC,MAAM,GAAG,KAAK,CAAC;IACxB,UAAU,oLAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;AAChC;AAEO,MAAM,iBAAiB,oLAAC,CAAC,MAAM,CAAC;IACnC,OAAO,oLAAC,CAAC,MAAM,GAAG,KAAK,CAAC;IACxB,UAAU,oLAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;IAC5B,aAAa,oLAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG,8CAA8C,QAAQ,GAAG,EAAE,CAAC,oLAAC,CAAC,OAAO,CAAC;AACzG;AAEO,eAAe,aAAa,QAAgB;IAC/C,MAAM,aAAa;IACnB,OAAO,6JAAM,CAAC,IAAI,CAAC,UAAU;AACjC;AAEO,eAAe,eAAe,QAAgB,EAAE,IAAY;IAC/D,OAAO,6JAAM,CAAC,OAAO,CAAC,UAAU;AACpC"}},
    {"offset": {"line": 56, "column": 0}, "map": {"version":3,"sources":["file:///home/safi/Desktop/WebDev/ed-tech-v2/src/app/api/auth/register/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\nimport db from \"@/data/db\";\nimport { RegisterSchema, hashPassword } from \"@/domain/auth\";\nimport { randomUUID } from \"node:crypto\";\n\nexport async function POST(request: Request) {\n    try {\n        const body = await request.json();\n        const validated = RegisterSchema.safeParse(body);\n\n        if (!validated.success) {\n            const firstError = validated.error.issues[0]?.message || \"Invalid input\";\n            return NextResponse.json(\n                { success: false, error: { code: \"VALIDATION_ERROR\", message: firstError } },\n                { status: 400 }\n            );\n        }\n\n        const { email, password, displayName } = validated.data;\n\n        // Check if user exists\n        const existingUser = await db.user.findUnique({\n            where: { email },\n        });\n\n        if (existingUser) {\n            return NextResponse.json(\n                { success: false, error: { code: \"CONFLICT\", message: \"This email is already registered\" } },\n                { status: 409 }\n            );\n        }\n\n        const passwordHash = await hashPassword(password);\n\n        const user = await db.user.create({\n            data: {\n                id: randomUUID(),\n                email,\n                passwordHash,\n                displayName,\n            },\n        });\n\n        return NextResponse.json(\n            { success: true, data: { userId: user.id, email: user.email } },\n            { status: 201 }\n        );\n    } catch (error) {\n        console.error(\"Registration error:\", error);\n        return NextResponse.json(\n            { success: false, error: { code: \"INTERNAL_ERROR\", message: \"Internal server error\" } },\n            { status: 500 }\n        );\n    }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;;;;;AAEO,eAAe,KAAK,OAAgB;IACvC,IAAI;QACA,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,MAAM,YAAY,yIAAc,CAAC,SAAS,CAAC;QAE3C,IAAI,CAAC,UAAU,OAAO,EAAE;YACpB,MAAM,aAAa,UAAU,KAAK,CAAC,MAAM,CAAC,EAAE,EAAE,WAAW;YACzD,OAAO,gJAAY,CAAC,IAAI,CACpB;gBAAE,SAAS;gBAAO,OAAO;oBAAE,MAAM;oBAAoB,SAAS;gBAAW;YAAE,GAC3E;gBAAE,QAAQ;YAAI;QAEtB;QAEA,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,WAAW,EAAE,GAAG,UAAU,IAAI;QAEvD,uBAAuB;QACvB,MAAM,eAAe,MAAM,8HAAE,CAAC,IAAI,CAAC,UAAU,CAAC;YAC1C,OAAO;gBAAE;YAAM;QACnB;QAEA,IAAI,cAAc;YACd,OAAO,gJAAY,CAAC,IAAI,CACpB;gBAAE,SAAS;gBAAO,OAAO;oBAAE,MAAM;oBAAY,SAAS;gBAAmC;YAAE,GAC3F;gBAAE,QAAQ;YAAI;QAEtB;QAEA,MAAM,eAAe,MAAM,IAAA,uIAAY,EAAC;QAExC,MAAM,OAAO,MAAM,8HAAE,CAAC,IAAI,CAAC,MAAM,CAAC;YAC9B,MAAM;gBACF,IAAI,IAAA,mIAAU;gBACd;gBACA;gBACA;YACJ;QACJ;QAEA,OAAO,gJAAY,CAAC,IAAI,CACpB;YAAE,SAAS;YAAM,MAAM;gBAAE,QAAQ,KAAK,EAAE;gBAAE,OAAO,KAAK,KAAK;YAAC;QAAE,GAC9D;YAAE,QAAQ;QAAI;IAEtB,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,uBAAuB;QACrC,OAAO,gJAAY,CAAC,IAAI,CACpB;YAAE,SAAS;YAAO,OAAO;gBAAE,MAAM;gBAAkB,SAAS;YAAwB;QAAE,GACtF;YAAE,QAAQ;QAAI;IAEtB;AACJ"}}]
}