{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/safi/Desktop/WebDev/ed-tech-v2/src/data/db.ts"],"sourcesContent":["import { PrismaClient } from \"@/prisma\";\n\nconst prismaClientSingleton = () => {\n    return new PrismaClient({\n        accelerateUrl: process.env.DATABASE_URL,\n    });\n};\n\ndeclare global {\n    var prisma: undefined | ReturnType<typeof prismaClientSingleton>;\n}\n\nconst db = globalThis.prisma ?? prismaClientSingleton();\n\nexport default db;\n\nif (process.env.NODE_ENV !== \"production\") globalThis.prisma = db;\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,wBAAwB;IAC1B,OAAO,IAAI,8IAAY,CAAC;QACpB,eAAe,QAAQ,GAAG,CAAC,YAAY;IAC3C;AACJ;AAMA,MAAM,KAAK,WAAW,MAAM,IAAI;uCAEjB;AAEf,wCAA2C,WAAW,MAAM,GAAG"}},
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file:///home/safi/Desktop/WebDev/ed-tech-v2/src/domain/auth.ts"],"sourcesContent":["import bcrypt from \"bcrypt\";\nimport { z } from \"zod\";\n\nexport const LoginSchema = z.object({\n    email: z.string().email(),\n    password: z.string().min(8),\n});\n\nexport const RegisterSchema = z.object({\n    email: z.string().email(),\n    password: z.string().min(8),\n    displayName: z.string().min(2).optional(),\n});\n\nexport async function hashPassword(password: string): Promise<string> {\n    const saltRounds = 12;\n    return bcrypt.hash(password, saltRounds);\n}\n\nexport async function verifyPassword(password: string, hash: string): Promise<boolean> {\n    return bcrypt.compare(password, hash);\n}\n"],"names":[],"mappings":";;;;;;;;;;AAAA;AACA;;;AAEO,MAAM,cAAc,oLAAC,CAAC,MAAM,CAAC;IAChC,OAAO,oLAAC,CAAC,MAAM,GAAG,KAAK;IACvB,UAAU,oLAAC,CAAC,MAAM,GAAG,GAAG,CAAC;AAC7B;AAEO,MAAM,iBAAiB,oLAAC,CAAC,MAAM,CAAC;IACnC,OAAO,oLAAC,CAAC,MAAM,GAAG,KAAK;IACvB,UAAU,oLAAC,CAAC,MAAM,GAAG,GAAG,CAAC;IACzB,aAAa,oLAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG,QAAQ;AAC3C;AAEO,eAAe,aAAa,QAAgB;IAC/C,MAAM,aAAa;IACnB,OAAO,6JAAM,CAAC,IAAI,CAAC,UAAU;AACjC;AAEO,eAAe,eAAe,QAAgB,EAAE,IAAY;IAC/D,OAAO,6JAAM,CAAC,OAAO,CAAC,UAAU;AACpC"}},
    {"offset": {"line": 56, "column": 0}, "map": {"version":3,"sources":["file:///home/safi/Desktop/WebDev/ed-tech-v2/src/app/api/auth/login/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\nimport db from \"@/data/db\";\nimport { LoginSchema, verifyPassword } from \"@/domain/auth\";\n\nexport async function POST(request: Request) {\n    try {\n        const body = await request.json();\n        const validated = LoginSchema.safeParse(body);\n\n        if (!validated.success) {\n            return NextResponse.json(\n                { success: false, error: { code: \"VALIDATION_ERROR\", message: \"Invalid input\", details: validated.error.format() } },\n                { status: 400 }\n            );\n        }\n\n        const { email, password } = validated.data;\n\n        const user = await db.user.findUnique({\n            where: { email },\n        });\n\n        if (!user) {\n            return NextResponse.json(\n                { success: false, error: { code: \"USER_NOT_FOUND\", message: \"User not found\" } },\n                { status: 401 }\n            );\n        }\n\n        if (!user.passwordHash) {\n            return NextResponse.json(\n                { success: false, error: { code: \"MISSING_PASSWORD_HASH\", message: \"User has no password hash set\" } },\n                { status: 401 }\n            );\n        }\n\n        const isValid = await verifyPassword(password, user.passwordHash);\n\n        if (!isValid) {\n            return NextResponse.json(\n                { success: false, error: { code: \"INVALID_PASSWORD\", message: \"Invalid password\" } },\n                { status: 401 }\n            );\n        }\n\n        // In a real app, we would set a session cookie here.\n        // For this test, we just return success.\n        return NextResponse.json(\n            { success: true, data: { userId: user.id, email: user.email, displayName: user.displayName } },\n            { status: 200 }\n        );\n    } catch (error) {\n        console.error(\"Login error:\", error);\n        return NextResponse.json(\n            { success: false, error: { code: \"INTERNAL_ERROR\", message: \"Internal server error\" } },\n            { status: 500 }\n        );\n    }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;AAEO,eAAe,KAAK,OAAgB;IACvC,IAAI;QACA,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,MAAM,YAAY,sIAAW,CAAC,SAAS,CAAC;QAExC,IAAI,CAAC,UAAU,OAAO,EAAE;YACpB,OAAO,gJAAY,CAAC,IAAI,CACpB;gBAAE,SAAS;gBAAO,OAAO;oBAAE,MAAM;oBAAoB,SAAS;oBAAiB,SAAS,UAAU,KAAK,CAAC,MAAM;gBAAG;YAAE,GACnH;gBAAE,QAAQ;YAAI;QAEtB;QAEA,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,UAAU,IAAI;QAE1C,MAAM,OAAO,MAAM,8HAAE,CAAC,IAAI,CAAC,UAAU,CAAC;YAClC,OAAO;gBAAE;YAAM;QACnB;QAEA,IAAI,CAAC,MAAM;YACP,OAAO,gJAAY,CAAC,IAAI,CACpB;gBAAE,SAAS;gBAAO,OAAO;oBAAE,MAAM;oBAAkB,SAAS;gBAAiB;YAAE,GAC/E;gBAAE,QAAQ;YAAI;QAEtB;QAEA,IAAI,CAAC,KAAK,YAAY,EAAE;YACpB,OAAO,gJAAY,CAAC,IAAI,CACpB;gBAAE,SAAS;gBAAO,OAAO;oBAAE,MAAM;oBAAyB,SAAS;gBAAgC;YAAE,GACrG;gBAAE,QAAQ;YAAI;QAEtB;QAEA,MAAM,UAAU,MAAM,IAAA,yIAAc,EAAC,UAAU,KAAK,YAAY;QAEhE,IAAI,CAAC,SAAS;YACV,OAAO,gJAAY,CAAC,IAAI,CACpB;gBAAE,SAAS;gBAAO,OAAO;oBAAE,MAAM;oBAAoB,SAAS;gBAAmB;YAAE,GACnF;gBAAE,QAAQ;YAAI;QAEtB;QAEA,qDAAqD;QACrD,yCAAyC;QACzC,OAAO,gJAAY,CAAC,IAAI,CACpB;YAAE,SAAS;YAAM,MAAM;gBAAE,QAAQ,KAAK,EAAE;gBAAE,OAAO,KAAK,KAAK;gBAAE,aAAa,KAAK,WAAW;YAAC;QAAE,GAC7F;YAAE,QAAQ;QAAI;IAEtB,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,gBAAgB;QAC9B,OAAO,gJAAY,CAAC,IAAI,CACpB;YAAE,SAAS;YAAO,OAAO;gBAAE,MAAM;gBAAkB,SAAS;YAAwB;QAAE,GACtF;YAAE,QAAQ;QAAI;IAEtB;AACJ"}}]
}